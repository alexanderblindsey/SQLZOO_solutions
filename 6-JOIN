#1. Show matchid, player for all goals scored by Germany.
SELECT matchid, player
FROM goal
WHERE teamid='GER'



#2. Show id, stadium, team1, team2 for just game 1012
SELECT id, stadium, team1, team2
FROM game
WHERE id = (SELECT matchid FROM goal # brings up game 1012
            WHERE player LIKE '%Bender')
            
            
            
#3. You can combine the above two steps with a single JOIN query. 
#   Show the player, teamid, stadium and mdate for every German goal.
SELECT player, teamid, stadium, mdate
FROM game JOIN goal ON (game.id=goal.matchid)
WHERE teamid='GER';



#4. Show the team1, team2 and player for every goal scored by a player called Mario
SELECT team1, team2, player
FROM game JOIN goal ON (game.id=goal.matchid)
WHERE player LIKE 'Mario%';



# 5. Show player, teamid, coach, gtime for all goals scored in the first 10 minutes gtime<=10
SELECT player, teamid, coach, gtime
FROM eteam JOIN goal ON (eteam.id=goal.teamid)
WHERE gtime<=10;



#6. List the dates of the matches and the name of the team in which 'Fernando Santos' was the team1 coach.
SELECT mdate, teamname
FROM game JOIN eteam ON (game.team1=eteam.id)
WHERE coach='Fernando Santos';



#7. Show every player that has scored in a game played in 'National Stadium, Warsaw'.
SELECT player
FROM goal JOIN game ON (goal.matchid=game.id)
WHERE stadium = 'National Stadium, Warsaw';



#8. Show the name of all players who have scored against Germany
SELECT DISTINCT player
  FROM goal JOIN game ON (goal.matchid=game.id)
    WHERE teamid != 'GER' AND 
     (team1='GER' OR
     team2='GER');
     
     
  
#9. Show teamname nd the total number of goals scored
SELECT teamname, COUNT(player)
  FROM eteam JOIN goal ON id=teamid
  GROUP BY teamname;
  
  
  
#10. Show the stadium and number of goals scored in each stadium
SELECT stadium, COUNT(player) as total_goals
FROM game JOIN goal ON (game.id=goal.matchid)
GROUP BY stadium;


#11. For every match involving 'POL', show the matchid, date and the number of goals scored.
WITH t1 AS (SELECT matchid, mdate
FROM goal JOIN game ON (goal.matchid=game.id)
WHERE team1='POL' OR team2='POL')

SELECT matchid, mdate, count(matchid)
FROM t1
GROUP BY (matchid);

